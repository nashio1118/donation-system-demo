# スプレッドシート修正手順書

## 概要
1ページ目の修正に伴い、スプレッドシートの構造を変更する必要があります。
以下の手順に従って修正を行ってください。

## 修正が必要なシート

### 1. 新しく作成するシート：「フォーム設定」

**シート作成手順：**
1. スプレッドシートの下部で右クリック
2. 「シートを挿入」を選択
3. シート名を「フォーム設定」に変更

**列構成：**
| 列A | 列B | 列C |
|-----|-----|-----|
| 設定キー | 設定値 | 有効/無効 |

**データ入力：**
```
A1: 設定キー        B1: 設定値                    C1: 有効/無効
A2: formTitle       B2: 奉加帳提出報告フォーム    C2: TRUE
A3: formSubtitle    B3: 〇〇大会振込報告フォーム  C3: TRUE
```

**使用方法：**
- B2セルを編集することで、フォームのメインタイトルを変更できます
- B3セルを編集することで、フォームのサブタイトルを変更できます
- 例：「インターハイ岡山予選振込報告フォーム」など

### 2. 修正するシート：「1ページ目データ整理」

**現在の列構成：**
```
A: 送信日時
B: 氏名
C: 学年
D: 振込日
E: 振込金額
F: 直接振込金額
G: 寄付金
H: 負担金
I: Tシャツ代
J: 奨励会負担金
K: 備考
```

**修正後の列構成：**
```
A: 送信日時
B: 氏名
C: 学年
D: 振込日
E: 振込金額
F: 直接振込金額
G: 寄付金
H: 負担金
I: Tシャツ代
J: 奨励会負担金
K: その他の費用          ← 新規追加
L: 兄弟1の名前          ← 新規追加
M: 兄弟2の名前          ← 新規追加
N: 兄弟3の名前          ← 新規追加
O: 兄弟4の名前          ← 新規追加
P: 兄弟5の名前          ← 新規追加
Q: 備考                 ← 位置変更（K→Q）
```

**修正手順：**
1. K列の「備考」列を右クリックして「6列を右に挿入」を選択
2. 新しく作成された列のヘッダーを以下のように変更：
   - K1: その他の費用
   - L1: 兄弟1の名前
   - M1: 兄弟2の名前
   - N1: 兄弟3の名前
   - O1: 兄弟4の名前
   - P1: 兄弟5の名前
   - Q1: 備考

### 3. 修正するシート：「寄付金一覧」

**現在の列構成：**
```
A: 氏名
B: 備考
C: 寄付金
D: 負担金
E: Tシャツ代
F: 奨励会負担金
G: 振込合計金額
H: 寄付・負担金計
```

**修正後の列構成：**
```
A: 氏名
B: 備考
C: 寄付金
D: 負担金
E: Tシャツ代
F: 奨励会負担金
G: その他の費用        ← 新規追加
H: 振込合計金額        ← 位置変更（G→H）
I: 寄付・負担金計      ← 位置変更（H→I）
```

**修正手順：**
1. G列の「振込合計金額」列を右クリックして「1列を右に挿入」を選択
2. 新しいG列のヘッダーを「その他の費用」に変更
3. H列が「振込合計金額」、I列が「寄付・負担金計」になっていることを確認

## データの変更点

### 負担金の計算方法
- **従来：** 1人分・2人分・なしの選択式
- **新方式：** 兄弟の人数に応じて自動計算
  - 本人のみ：40,000円 × 1人 = 40,000円
  - 本人＋兄弟1人：40,000円 × 2人 = 80,000円
  - 本人＋兄弟2人：40,000円 × 3人 = 120,000円
  - （以下同様、最大6人まで）

### 学年の入力方式
- **従来：** 自由入力（例：小学6年生）
- **新方式：** 選択式（1年・2年・3年）

### 兄弟情報の追加
- 兄弟がいる場合、最大5人まで名前を記録
- 兄弟の人数に応じて負担金が自動計算される

## 注意事項

1. **データ移行について**
   - 既存のデータがある場合は、列を挿入する前にバックアップを取ってください
   - 新しい列（その他の費用、兄弟の名前）には空の値が入ります

2. **フォーム設定の反映**
   - フォーム設定シートを作成後、Webページを再読み込みすると新しいタイトルが表示されます
   - 設定が反映されない場合は、ブラウザのキャッシュをクリアしてください

3. **Google Apps Scriptの更新**
   - スプレッドシートの修正と併せて、Google Apps Scriptのコードも更新する必要があります
   - 新しいコードは `google-apps-script-config.gs` ファイルを参照してください

## 確認項目

修正完了後、以下を確認してください：

- [ ] フォーム設定シートが作成され、適切なデータが入力されている
- [ ] 1ページ目データ整理シートに新しい列が追加されている
- [ ] 寄付金一覧シートに「その他の費用」列が追加されている
- [ ] 既存のデータが正しい位置に表示されている
- [ ] Webフォームでタイトルが正しく表示されている

## トラブルシューティング

### フォームタイトルが変更されない場合
1. フォーム設定シートの設定キーが正しいか確認（formTitle, formSubtitle）
2. 有効/無効列がTRUEになっているか確認
3. ブラウザのキャッシュをクリア
4. Google Apps Scriptが正しく更新されているか確認

### データが正しく保存されない場合
1. スプレッドシートの列構成が指示通りになっているか確認
2. Google Apps Scriptのログでエラーがないか確認
3. 必要に応じて、Apps Scriptを再デプロイ

ご不明な点がございましたら、お気軽にお問い合わせください。